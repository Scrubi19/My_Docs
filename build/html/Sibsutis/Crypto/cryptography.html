

<!DOCTYPE html>
<html class="writer-html4" lang="ru" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Криптографические методы защиты информации &mdash; Документация My_Docs 0.0.1</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/main.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script type="text/javascript" src="../../_static/translations.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Алфавитный указатель" href="../../genindex.html" />
    <link rel="search" title="Поиск" href="../../search.html" />
    <link rel="next" title="LLVM: инфраструктура для разработки компилятора" href="../Compilers/llvm.html" />
    <link rel="prev" title="Шпаргалки" href="../Cheat_sheets/cheat.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #343131" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/logo2.svg" class="logo" alt="Логотип"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Поиск в документации" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Cheat_sheets/cheat.html">Шпаргалки</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Cheat_sheets/cheat.html#git">Git</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Cheat_sheets/cheat.html#id2">Создание репозитория</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheat_sheets/cheat.html#id3">Команды</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheat_sheets/cheat.html#gitignore">Памятка по .gitignore</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Cheat_sheets/cheat.html#bash">BASH</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Cheat_sheets/cheat.html#id5">Команды</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheat_sheets/cheat.html#id6">Переменные и параметры скрипта</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheat_sheets/cheat.html#id7">Зарезервированные переменные</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheat_sheets/cheat.html#id8">Условия</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Криптографические методы защиты информации</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id2">Глава 1. Криптосистемы с открытым ключом</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">Быстрое возведение в степень по модулю</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">Элементы теории чисел</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">Обобщенный алгоритм Эвклида</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">Система Диффи-Хеллмана</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7">Шифр Шамира</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id8">Шифр Эль Гамаля</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rsa">Шифр RSA</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id9">Глава 2. Методы взлома шифров, основанных на дискретном логарифмировании</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id10">Метод «шаг младенца, шаг великана»</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id11">Используемая литература</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Compilers/llvm.html">LLVM: инфраструктура для разработки компилятора</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Compilers/llvm.html#id1">Установка LLVM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Compilers/llvm.html#id2">Инструменты и организация</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Compilers/llvm.html#id3">LLVM сегодня</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Compilers/llvm.html#id4">Взаимодействие с драйвером компилятора</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Compilers/llvm.html#id5">Использование автономных инструментов</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Compilers/llvm.html#id6">Как это работает?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Compilers/llvm.html#c-llvm">Приемы программирования на C++ в LLVM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Compilers/llvm.html#id8">Демонстрация расширяемого интерфейса проходов</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Compilers/llvm.html#tablegen-td">TableGen(.td)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Compilers/llvm.html#id10">Анализатор исходного кода</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Compilers/llvm.html#id11">Лексический анализ</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Compilers/llvm.html#clang-libtoling">Инструменты Clang и фреймворк LibToling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Compilers/llvm.html#clang-tidy">Clang-tidy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Compilers/llvm.html#clang-modernizer">Clang Modernizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Compilers/llvm.html#clang-apply-replacements">Clang Apply Replacements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Compilers/llvm.html#clangformat">ClangFormat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Compilers/llvm.html#modularize">Modularize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Compilers/llvm.html#module-map-checker">Module Map Checker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Compilers/llvm.html#pptrace">PPTrace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Compilers/llvm.html#clang-query">Clang-Query</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Compilers/llvm.html#clang-check">Clang-Check</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Compilers/llvm.html#c-str">Удаление вызовов c_str() «Самый маленький инструмент для рефакторинга»</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Compilers/llvm.html#id12">Создание собственного инструмента</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Compilers/llvm.html#id13">Используемая литература</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Ruby/ruby.html">Ruby on Rails</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ruby/ruby.html#ubuntu">Установка на Ubuntu</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Databases/Databases.html">Базы данных</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Databases/Databases.html#id2">Реляционные базы данных</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Databases/Databases.html#id3">Реляционная алгебра</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Databases/Databases.html#sql-structed-query-language">SQL(Structed Query Language)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Databases/Databases.html#id4">Нереляционные базы данных</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Databases/Databases.html#id5">Используемая литература</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">My_Docs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Криптографические методы защиты информации</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/Sibsutis/Crypto/cryptography.rst.txt" rel="nofollow"> Просмотреть исходный код страницы</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1>Криптографические методы защиты информации<a class="headerlink" href="#id1" title="Ссылка на этот заголовок">¶</a></h1>
<div class="section" id="id2">
<h2>Глава 1. Криптосистемы с открытым ключом<a class="headerlink" href="#id2" title="Ссылка на этот заголовок">¶</a></h2>
<div class="section" id="id3">
<h3>Быстрое возведение в степень по модулю<a class="headerlink" href="#id3" title="Ссылка на этот заголовок">¶</a></h3>
<p>Односторонняя функция (англ.&nbsp;one-way function, OWF)&nbsp;-  &nbsp;математическая функция, которая легко вычисляется для любого входного значения, но трудно найти аргумент по заданному значению функции. В криптографических задачах в качестве односторонней функции часто используется функция:</p>
<div class="math notranslate nohighlight">
\[{ y = a^{x}\bmod p }\]</div>
<p>Обратная функция называется дискретным логарифмом и является трудновычислимой:</p>
<div class="math notranslate nohighlight">
\[{ x = log_a(y)\bmod p }\]</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../../_images/2.1.png"><img alt="table" src="../../_images/2.1.png" style="width: 650px;" /></a>
</div>
<p>Перейдем к описанию алгоритма быстрого возведения числа в степень по модулю. Любое десятичное число может быть представлено в виде полинома степеней двойки</p>
<div class="math notranslate nohighlight">
\[x = x_02^{0} + x_12^{1}+ ...+x_t2^{t}\]</div>
<p>Описание хода вычислений алгоритма:</p>
<div class="math notranslate nohighlight">
\[\begin{split}a^{x} \bmod m = y \\
23^{15} \bmod 17 = ?\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}15_{10} = 1111_2 = 2^{0}+2^{1}+2^{2}+2^{3} =&gt; \quad 23^{15} = 23^{2^{0}+2^{1}+2^{2}+2^{3}} \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}(23^{2^{0}} * 23^{2^{1}} * 23^{2^{2}} * 23^{2^{3}}) \bmod 17 = y  \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}(23^{2^{0}} \bmod 17 * 23^{2^{1}} \bmod 17 * 23^{2^{2}} \bmod 17 * 23^{2^{3}} \bmod 17) \bmod 17 = y \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}1) 23^{2^{0}} \bmod 17 &amp;= 6 \quad 23^{2^{1}} = 23^{2^{0}} * 23^{2^{0}} \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}2) 23^{2^{1}} \bmod 17 = ((23^{2^{0}} \bmod 17 )*(23^{2^{0}} \bmod 17)) \bmod 17 &amp;= (6 * 6) \bmod 17 = 36 \bmod 17 = 2 \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}3) 23^{2^{2}} \bmod 17 = ((23^{2^{1}} \bmod 17 )*(23^{2^{1}} \bmod 17)) \bmod 17 &amp;= (2*2) \bmod 17 = 4 \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}4)23^{2^{3}} \bmod 17 = ((23^{2^{2}} \bmod 17 )*(23^{2^{2}} \bmod 17)) \bmod 17 &amp;= (4*4) \bmod 17 = 16 \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}Ответ: 23^{15} \bmod 17 = (6*2*4*16) \bmod 17 = 3 \\\end{split}\]</div>
<p>Листинг программы:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">calculate</span><span class="o">(</span> <span class="kt">long</span> <span class="n">a</span><span class="o">,</span> <span class="kt">long</span> <span class="n">x</span><span class="o">,</span> <span class="kt">long</span> <span class="n">p</span> <span class="o">)</span> <span class="o">{</span>
    <span class="kt">long</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="k">if</span><span class="o">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">p</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Negative numbers and p=0 are not supported&quot;</span><span class="o">);</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">2</span><span class="o">;</span>
    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">p</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="k">while</span><span class="o">(</span><span class="n">x</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">((</span><span class="n">x</span><span class="o">&amp;</span><span class="mi">1</span><span class="o">)</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">y</span> <span class="o">=</span> <span class="o">(</span><span class="n">y</span> <span class="o">*</span> <span class="n">a</span><span class="o">)%</span><span class="n">p</span><span class="o">;</span>
                <span class="n">t</span><span class="o">++;</span>
            <span class="o">}</span>
            <span class="n">a</span> <span class="o">=</span> <span class="o">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">a</span><span class="o">)</span> <span class="o">%</span> <span class="n">p</span><span class="o">;</span>
            <span class="n">x</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="o">;</span>
        <span class="o">}</span>
<span class="c1">//            System.out.println(&quot;\nNumber of Iteration = &quot;+t);</span>
        <span class="k">return</span> <span class="n">y</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Примечание</p>
<p class="last">Количество операций умножения при вычислении по описанному методу не превосходит <em>2log x</em></p>
</div>
<div class="admonition attention">
<p class="first admonition-title">Внимание</p>
<p class="last"><strong>Доказательство</strong>: Для вычисления чисел ряда требуется t умножений,     для вычисления y не более, чем t умножений. Из условия <em>t = [log x]</em> , учитывая,   что <em>log x ≤ log x</em>, делаем вывод о справедливости доказываемого утверждения</p>
</div>
</div>
<div class="section" id="id4">
<h3>Элементы теории чисел<a class="headerlink" href="#id4" title="Ссылка на этот заголовок">¶</a></h3>
<ul class="simple">
<li>Число называется простым, если оно не делится ни на какое другое число, кроме самого себя и единицы (11, 23)</li>
<li>Любое целое положительное число  может быть представлено в виде произведения простых чисел, причем единственным образом (27 = 3*3 * 3,33)</li>
<li>Два числа называются взаимно простыми если они не имеют ни одного общего делителя кроме единицы (27 и 28)</li>
<li><strong>Функция Эйлера</strong>. Пусть дано целое число N &gt;= 1. Значение функции Эйлера ф(N) равно количеству чисел в ряду 1,2,3, … ,N - 1, взаимно простых с N</li>
</ul>
<blockquote>
<div><div class="figure align-center">
<a class="reference internal image-reference" href="../../_images/2.2.png"><img alt="phi" src="../../_images/2.2.png" style="width: 600px;" /></a>
</div>
<ul class="simple">
<li>Если p-простое число, то <span class="math notranslate nohighlight">\(\quad \varphi(p) = p - 1 \\\)</span></li>
<li>Если p и q - два различных простых числа ( p != q). Тогда</li>
</ul>
</div></blockquote>
<div class="math notranslate nohighlight">
\[{ \varphi(pq) = (p-1)(q-1)}\]</div>
<ul class="simple">
<li><strong>Теорема Ферма</strong>. Пусть p - простое число и 0 &lt; a &lt; p. Тогда</li>
</ul>
<div class="math notranslate nohighlight">
\[{ a^{p-1}\bmod p = 1 }\]</div>
<ul class="simple">
<li><strong>Теорема Эйлера</strong>. Пусть a и b - взаимно простые числа. Тогда</li>
</ul>
<div class="math notranslate nohighlight">
\[{ a^{\varphi(b)}\bmod b = 1 }\]</div>
</div>
<div class="section" id="id5">
<h3>Обобщенный алгоритм Эвклида<a class="headerlink" href="#id5" title="Ссылка на этот заголовок">¶</a></h3>
<p>Пусть a и b — два целых положительных числа. Наибольший общий делитель чисел a и b есть наибольшее число c, которое делит и a и b :</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[{ c = gcd(a, b) }\]</div>
</div></blockquote>
<div class="figure align-center">
<a class="reference internal image-reference" href="../../_images/gcd.png"><img alt="gcd" src="../../_images/gcd.png" style="width: 600px;" /></a>
</div>
<p>Пусть a и b — два целых положительных числа. Тогда существуют целые (не обязательно положительные) числа x и y , такие, что</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[{ ax + by = gcd(a, b) }\]</div>
</div></blockquote>
<p>Введем три строки <span class="math notranslate nohighlight">\(U = (u_1 , u_2 , u_3 ), V = (v_1 , v_2 , v_3 ), T = (t_1 , t_2 , t_3 )\)</span>. Тогда алгоритм записывается следующим образом:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../../_images/Euclid.png"><img alt="Euclid" src="../../_images/Euclid.png" style="width: 600px;" /></a>
</div>
<p>Описание хода вычислений алгоритма:</p>
<div class="math notranslate nohighlight">
\[\begin{split}Euclid(17, 9) \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}ax + by = gcd(a,b) \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}U(a, 1, 0) \quad  V(b, 0, 1) \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}1) q = U1 \ div \  V1 = 1\\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}T = (U1 \bmod V1; U2 - qV2; U3 - qV3 ) \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}T = (8, 1, -1) \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}U = V, V = T \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}U = (9,0,1) \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}V = (8,1,-1) \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}2)q = 1 \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}T = (1, -1, 2) \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}U = (8,1,-1) \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}V = (1,-1,2) \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}3)q = 8 \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}T = (0, -9,-17) \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}U = (1,-1,2) \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}V = (0,9,-17) \\\\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}Когда \ V1 = 0, тогда \ в \ U \ лежат \ ответы \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}gcd(a,b) = 1, \ x = -1, \ y = 2 \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}17*(-1) + 9*2 = 1 \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}-17+18 = 1 \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}1 = 1 \\\end{split}\]</div>
<p>Листинг программы:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">static</span> <span class="kt">long</span><span class="o">[]</span> <span class="nf">calculate</span><span class="o">(</span><span class="kt">long</span> <span class="n">a</span><span class="o">,</span> <span class="kt">long</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">long</span> <span class="n">temp</span><span class="o">;</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">a</span><span class="o">;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">b</span><span class="o">;</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">temp</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kt">long</span><span class="o">[]</span> <span class="n">U</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">long</span><span class="o">[]{</span><span class="n">a</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">};</span>
    <span class="kt">long</span><span class="o">[]</span> <span class="n">V</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">long</span><span class="o">[]{</span><span class="n">b</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">};</span>
    <span class="kt">long</span><span class="o">[]</span> <span class="n">T</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">long</span><span class="o">[</span><span class="mi">3</span><span class="o">];</span>
    <span class="kt">long</span> <span class="n">q</span><span class="o">;</span>
    <span class="k">while</span> <span class="o">(</span><span class="n">V</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">U</span><span class="o">[</span><span class="mi">0</span><span class="o">]/</span><span class="n">V</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
        <span class="n">T</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="n">U</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">%</span> <span class="n">V</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
        <span class="n">T</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="n">U</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">-</span> <span class="n">q</span> <span class="o">*</span> <span class="n">V</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span>
        <span class="n">T</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">=</span> <span class="n">U</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">-</span> <span class="n">q</span> <span class="o">*</span> <span class="n">V</span><span class="o">[</span><span class="mi">2</span><span class="o">];</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">U</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">V</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
            <span class="n">V</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">T</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">U</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id6">
<h3>Система Диффи-Хеллмана<a class="headerlink" href="#id6" title="Ссылка на этот заголовок">¶</a></h3>
<p>Эта криптосистема была открыта в середине 70-х годов американскими учеными Диффи (Whitfield Diffie) и Хеллманом (Martin Hellman) и привела к настоящей революции в криптографии и ее практических применениях. Для обеспечения высокой стойкости рассмотренной системы число p-1 должно обязательно содержать большой простой множитель. Рекомендуют использовать следующее:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[P = 2Q + 1 , \ где \ Q - простое \ число\]</div>
</div></blockquote>
<p>Для Q должны выполняться условия:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[{ 1 &lt; G &lt; P − 1  \quad и \quad G^{Q}\bmod P != 1 }\]</div>
</div></blockquote>
<p>Согласно малой теореме Ферма можно утверждать,что если для какого-то числа a &lt; P выполняется условие <span class="math notranslate nohighlight">\(a^{P-1} \bmod P != 1\)</span> ,  то число  является составным. Исходя из данного утверждения, можно легко разработать тест Ферма для проверки на простоту:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">bool</span> <span class="n">testFerma</span><span class="p">(</span><span class="n">long</span> <span class="n">long</span> <span class="n">p</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">)</span> <span class="p">{</span>
 <span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">return</span> <span class="n">true</span><span class="p">;</span>
 <span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span>  <span class="k">return</span> <span class="n">false</span><span class="p">;</span>
 <span class="k">for</span><span class="p">(</span><span class="nb">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">k</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
   <span class="n">long</span> <span class="n">long</span> <span class="n">a</span><span class="o">=</span><span class="n">rand</span><span class="p">()</span><span class="o">%</span><span class="p">(</span><span class="n">P</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
   <span class="k">if</span><span class="p">(</span><span class="n">gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="o">!=</span><span class="mi">1</span> <span class="o">||</span> <span class="n">powMod</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="o">!=</span><span class="mi">1</span><span class="p">)</span>
     <span class="k">return</span> <span class="n">false</span><span class="p">;</span>
 <span class="p">}</span>
 <span class="k">return</span> <span class="n">true</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Абоненты выбирают большие числа Xa, Xb, Xc, которые храняться в секрете. Каждый абонент вычисляет соответсвующее число Y, которое открыто передается другим абонентам</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin {cases} {Y_A = g^{X_A} \bmod p} \\
   {Y_B = g^{X_B} \bmod p} \\
   {Y_C = g^{X_C} \bmod p} \\
  \end {cases}\end{split}\]</div>
<p>Допустим, абонент A решил организовать сеанс связи с B, при этом обоим абонентам доступна открытая информация (P, G, Y). Абонент A сообщает B по открытому каналу, что он хочет передать ему сообщение. Затем абонент A вычисляет величину:</p>
<div class="math notranslate nohighlight">
\[{Z_{AB} = (Y_B)^{X_A} \bmod p}\]</div>
<p>В свою очередь, абонент B вычисляет число:</p>
<div class="math notranslate nohighlight">
\[{Z_{BA} = (Y_A)^{X_B} \bmod p}\]</div>
<p>Получаем что:</p>
<div class="math notranslate nohighlight">
\[{Z_{BA} = Z_{AB} }\]</div>
<p>Доказательство:</p>
<div class="math notranslate nohighlight">
\[\begin{split}{Z_{AB} = (Y_B)^{X_A} \bmod p = (g^{X_B})^{X_A} \bmod p = \\
    = g^{X_A X_B} \bmod p = (Y_A)^{X_B} \bmod p = Z_{BA} }\end{split}\]</div>
<dl class="docutils">
<dt>Пример:</dt>
<dd>Пусть P = 23 = 2 · 11 + 1 (Q = 11). Выберем параметр G. Попробуем взять g = 3. Проверим: 3^11 mod 23 = 1 и значит, такое g не подходит. Возьмем g = 5. Проверим: 5^11 mod 23 = 22. Итак, мы выбрали параметры p = 23, g = 5. Теперь каждый абонент выбирает секретное число и вычисляет соответствующее ему открытое число. Пусть выбраны Xa = 7 , Xb = 13 . Вычисляем Ya = 5^7 mod 23 = 17, Yb = 5^13 mod 23 = 21. Пусть A и B решили сформировать общий секретный ключ. Для этого A вычисляет Zab = 21^7 mod 23 = 10, а B вычисляет Zba = 17^13 mod 23 = 10.Теперь они имеют общий ключ 10, который не передавался по каналу связи</dd>
</dl>
<p>Листинг программы:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// Diffie-Hellman.java</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">generateParameters</span><span class="o">(){</span>
        <span class="n">SecureRandom</span> <span class="n">srand</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SecureRandom</span><span class="o">();</span>
        <span class="n">srand</span><span class="o">.</span><span class="na">setSeed</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">());</span>
        <span class="kt">long</span> <span class="n">Q</span><span class="o">;</span>
        <span class="k">do</span> <span class="o">{</span>
            <span class="n">Q</span> <span class="o">=</span> <span class="n">srand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">MAX_VALUE</span><span class="o">-</span><span class="mi">3</span><span class="o">)+</span><span class="mi">2</span><span class="o">;</span>
            <span class="n">P</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*(</span><span class="kt">int</span><span class="o">)</span><span class="n">Q</span> <span class="o">+</span><span class="mi">1</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">while</span><span class="o">(!</span><span class="n">isPrime</span><span class="o">(</span><span class="n">Q</span><span class="o">)</span> <span class="o">||</span> <span class="o">!</span><span class="n">isPrime</span><span class="o">(</span><span class="n">P</span><span class="o">)</span> <span class="o">||</span> <span class="o">!</span><span class="n">testFerma</span><span class="o">(</span><span class="n">P</span><span class="o">,</span><span class="mi">100</span><span class="o">));</span>

        <span class="k">do</span> <span class="o">{</span>
            <span class="n">G</span> <span class="o">=</span> <span class="n">srand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">P</span><span class="o">-</span><span class="mi">3</span><span class="o">)+</span><span class="mi">2</span><span class="o">;</span><span class="c1">// 1 &lt; q &lt; p -1</span>
        <span class="o">}</span> <span class="k">while</span><span class="o">(</span><span class="n">ModularExponentiation</span><span class="o">.</span><span class="na">calculate</span><span class="o">(</span><span class="n">G</span><span class="o">,</span><span class="n">Q</span><span class="o">,</span><span class="n">P</span><span class="o">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">);</span>

        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;P = &quot;</span><span class="o">+</span><span class="n">P</span><span class="o">+</span><span class="s">&quot; G = &quot;</span><span class="o">+</span><span class="n">G</span><span class="o">+</span><span class="s">&quot; Q = &quot;</span><span class="o">+</span><span class="n">Q</span><span class="o">);</span>
    <span class="o">}</span>
<span class="c1">// Abonent.java</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Abonent</span> <span class="o">{</span>
    <span class="n">DiffieHellman</span> <span class="n">diffieHellman</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">long</span> <span class="n">secretKey</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">long</span> <span class="n">publicKey</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Abonent</span><span class="o">(</span><span class="n">DiffieHellman</span> <span class="n">diffieHellman</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">diffieHellman</span> <span class="o">=</span> <span class="n">diffieHellman</span><span class="o">;</span>
        <span class="n">SecureRandom</span> <span class="n">srand</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SecureRandom</span><span class="o">();</span>
        <span class="n">srand</span><span class="o">.</span><span class="na">setSeed</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">());</span>
        <span class="n">secretKey</span> <span class="o">=</span> <span class="n">srand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">diffieHellman</span><span class="o">.</span><span class="na">getP</span><span class="o">()-</span><span class="mi">2</span><span class="o">)+</span><span class="mi">1</span><span class="o">;</span>
        <span class="n">publicKey</span> <span class="o">=</span> <span class="n">ModularExponentiation</span><span class="o">.</span><span class="na">calculate</span><span class="o">(</span><span class="n">diffieHellman</span><span class="o">.</span><span class="na">getG</span><span class="o">(),</span><span class="n">secretKey</span><span class="o">,</span> <span class="n">diffieHellman</span><span class="o">.</span><span class="na">getP</span><span class="o">());</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">long</span> <span class="nf">calculateZ</span><span class="o">(</span><span class="kt">long</span> <span class="n">publicSecondAbonentKey</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">ModularExponentiation</span><span class="o">.</span><span class="na">calculate</span><span class="o">(</span><span class="n">publicSecondAbonentKey</span><span class="o">,</span> <span class="n">secretKey</span><span class="o">,</span> <span class="n">diffieHellman</span><span class="o">.</span><span class="na">getP</span><span class="o">());</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id7">
<h3>Шифр Шамира<a class="headerlink" href="#id7" title="Ссылка на этот заголовок">¶</a></h3>
<p>Этот шифр, предложенный Шамиром (Adi Shamir), был первым, позволяющим организовать обмен секретными сообщениями по открытой линии связи для лиц, которые не имеют никаких защищенных каналов и секретных ключей и, возможно, никогда не видели друг друга.</p>
<p>Пусть есть два абонента A и B, соединенные линией связи. A хочет передать сообщение m абоненту B так, чтобы никто не узнал его содержание. A выбирает случайное большое простое число P и открыто передает его B. Затем A выбирает два числа Ca и Da , такие, что</p>
<div class="math notranslate nohighlight">
\[\begin{split}{ C_A*D_A \bmod (P-1) = 1  \\
    C_B*D_B \bmod (P-1) = 1 }\end{split}\]</div>
<p>Вычисляем C и D, используя обобщенный алгоритм Эвклида</p>
<div class="math notranslate nohighlight">
\[\begin{split}Вычисляем \ y: \ ax + by = gcd(a, b) ,\ где \ C \ рандомное \ число \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}если \ gcd(С, P-1) \ = \ 1, \ то \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[D = y + (P - 1)\]</div>
<p>Листинг программы вычисляющей C и D:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Shamir</span> <span class="o">{</span>
   <span class="kd">private</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">P</span><span class="o">;</span>
   <span class="kd">private</span> <span class="kt">long</span> <span class="n">C</span><span class="o">;</span>
   <span class="kd">private</span> <span class="kt">long</span> <span class="n">D</span><span class="o">;</span>

   <span class="kd">public</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">generatePublicP</span><span class="o">()</span> <span class="o">{</span>
       <span class="n">SecureRandom</span> <span class="n">srand</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SecureRandom</span><span class="o">();</span>
       <span class="n">srand</span><span class="o">.</span><span class="na">setSeed</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">());</span>
       <span class="kt">long</span> <span class="n">P</span><span class="o">;</span>
       <span class="k">do</span> <span class="o">{</span>
           <span class="n">P</span> <span class="o">=</span> <span class="n">srand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">MAX_VALUE</span><span class="o">-</span><span class="mi">3</span><span class="o">)+</span><span class="mi">2</span><span class="o">;</span>
       <span class="o">}</span> <span class="k">while</span><span class="o">(!</span><span class="n">DiffieHellman</span><span class="o">.</span><span class="na">isPrime</span><span class="o">(</span><span class="n">P</span><span class="o">)</span> <span class="o">||</span> <span class="o">!</span><span class="n">DiffieHellman</span><span class="o">.</span><span class="na">testFerma</span><span class="o">(</span><span class="n">P</span><span class="o">,</span><span class="mi">100</span><span class="o">));</span>
       <span class="k">return</span> <span class="n">P</span><span class="o">;</span>
   <span class="o">}</span>

   <span class="kd">public</span> <span class="nf">Shamir</span><span class="o">(</span><span class="kt">long</span> <span class="n">P</span><span class="o">)</span> <span class="o">{</span>
       <span class="k">this</span><span class="o">.</span><span class="na">P</span> <span class="o">=</span> <span class="n">P</span><span class="o">;</span>
       <span class="n">SecureRandom</span> <span class="n">srand</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SecureRandom</span><span class="o">();</span>
       <span class="n">srand</span><span class="o">.</span><span class="na">setSeed</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">());</span>
       <span class="kt">long</span><span class="o">[]</span> <span class="n">EuclidResult</span><span class="o">;</span>
       <span class="k">do</span> <span class="o">{</span>
           <span class="k">do</span> <span class="o">{</span>
               <span class="k">this</span><span class="o">.</span><span class="na">C</span> <span class="o">=</span> <span class="n">srand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">MAX_VALUE</span><span class="o">-</span><span class="mi">3</span><span class="o">)+</span><span class="mi">2</span><span class="o">;</span>
               <span class="n">EuclidResult</span> <span class="o">=</span> <span class="n">Euclid</span><span class="o">.</span><span class="na">calculate</span><span class="o">(</span><span class="n">C</span><span class="o">,</span><span class="n">P</span><span class="o">-</span><span class="mi">1</span><span class="o">);</span>
           <span class="o">}</span> <span class="k">while</span><span class="o">(</span><span class="n">EuclidResult</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="o">);</span>
           <span class="k">this</span><span class="o">.</span><span class="na">D</span> <span class="o">=</span> <span class="n">EuclidResult</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">+</span> <span class="o">(</span><span class="n">P</span><span class="o">-</span><span class="mi">1</span><span class="o">);</span>
       <span class="o">}</span> <span class="k">while</span><span class="o">(</span><span class="n">C</span><span class="o">*</span><span class="n">D</span><span class="o">%(</span><span class="n">P</span><span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="o">);</span>
   <span class="o">}</span>
 <span class="o">}</span>
</pre></div>
</div>
<p>После этого A передает свое сообщение m. Если m &lt; P, то сообщение передается сразу, если же m &gt;= P, то сообщение разбивается на части. Рассмотрим случай m &lt; P
<strong>Шаг 1.</strong> A вычисляет число</p>
<div class="math notranslate nohighlight">
\[{x_1 = m^{C_A} \bmod p, }\]</div>
<p><strong>Шаг 2.</strong> B получив x1, вычисляет</p>
<div class="math notranslate nohighlight">
\[{x_2 = x_1^{C_B} \bmod p, }\]</div>
<p><strong>Шаг 3.</strong> A вычисляет число</p>
<div class="math notranslate nohighlight">
\[{x_3 = x_2^{D_A} \bmod p, }\]</div>
<p><strong>Шаг 4.</strong> B получив x3, вычисляет</p>
<div class="math notranslate nohighlight">
\[{x_4 = x_3^{D_B} \bmod p, }\]</div>
<p>Пример хода алгоритма:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="o">=</span> <span class="mi">23</span><span class="o">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">6</span>
<span class="nl">A:</span>  <span class="n">Ca</span> <span class="o">=</span> <span class="mi">7</span><span class="o">,</span>  <span class="n">Da</span> <span class="o">=</span> <span class="mi">19</span>
<span class="nl">B:</span>   <span class="n">Cb</span> <span class="o">=</span> <span class="mi">13</span><span class="o">,</span>  <span class="n">Db</span> <span class="o">=</span> <span class="mi">17</span>

<span class="n">x1</span><span class="o">,</span>  <span class="n">x2</span><span class="o">,</span>  <span class="n">x3</span><span class="o">,</span>  <span class="n">x4</span>  <span class="o">(==</span><span class="mi">6</span><span class="o">)</span>

<span class="mi">22</span> <span class="mi">0</span>  <span class="o">(</span><span class="n">выбрасываем</span> <span class="n">второй</span> <span class="n">столбец</span><span class="o">)</span>
<span class="mi">7</span>  <span class="mi">1</span>
<span class="o">----</span>
<span class="mi">1</span> <span class="o">-</span><span class="mi">3</span>   <span class="n">q</span> <span class="o">=</span> <span class="mi">22</span> <span class="o">/</span> <span class="mi">7</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">Da</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span><span class="o">+</span><span class="mi">22</span> <span class="o">=</span> <span class="mi">19</span>

<span class="mi">22</span> <span class="mi">0</span>
<span class="mi">13</span> <span class="mi">1</span>
<span class="o">----</span>
<span class="mi">9</span> <span class="o">-</span><span class="mi">1</span>       <span class="n">q</span> <span class="o">=</span> <span class="mi">22</span> <span class="o">/</span> <span class="mi">13</span> <span class="o">=</span> <span class="mi">1</span>
<span class="mi">4</span>  <span class="mi">2</span>       <span class="n">q</span> <span class="o">=</span> <span class="mi">13</span> <span class="o">/</span> <span class="mi">9</span> <span class="o">=</span> <span class="mi">1</span>
<span class="mi">1</span>  <span class="o">-</span><span class="mi">5</span>      <span class="n">q</span> <span class="o">=</span> <span class="mi">9</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">Db</span> <span class="o">=</span> <span class="mi">22</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">=</span> <span class="mi">17</span>

<span class="nl">A:</span> <span class="n">x1</span> <span class="o">=</span> <span class="mi">6</span><span class="o">^</span><span class="mi">7</span> <span class="n">mod</span> <span class="mi">23</span> <span class="o">=</span> <span class="mi">3</span>
<span class="nl">B:</span> <span class="n">x2</span> <span class="o">=</span> <span class="mi">3</span><span class="o">^</span><span class="mi">13</span> <span class="n">mod</span> <span class="mi">23</span> <span class="o">=</span> <span class="mi">9</span>
<span class="nl">A:</span> <span class="n">x3</span> <span class="o">=</span> <span class="mi">9</span><span class="o">^</span><span class="mi">19</span> <span class="n">mod</span> <span class="mi">23</span> <span class="o">=</span> <span class="mi">13</span>
<span class="nl">B:</span> <span class="n">x4</span> <span class="o">=</span> <span class="mi">13</span><span class="o">^</span><span class="mi">17</span> <span class="n">mod</span> <span class="mi">23</span> <span class="o">=</span> <span class="mi">6</span>
</pre></div>
</div>
<p>Листинг программы:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// Shamir.java</span>
<span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="nf">ShamirCalcIteration</span><span class="o">(</span><span class="n">String</span> <span class="n">path</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="n">prevX</span><span class="o">,</span> <span class="kt">int</span> <span class="n">numOfIteration</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
       <span class="k">switch</span> <span class="o">(</span><span class="n">numOfIteration</span><span class="o">)</span> <span class="o">{</span>
           <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
               <span class="kt">byte</span><span class="o">[]</span> <span class="n">byteArray</span> <span class="o">=</span> <span class="n">getFileBytes</span><span class="o">(</span><span class="n">path</span><span class="o">);</span>
               <span class="n">List</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="n">x1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>

               <span class="k">for</span> <span class="o">(</span><span class="kt">byte</span> <span class="n">a</span> <span class="o">:</span> <span class="n">byteArray</span><span class="o">)</span> <span class="o">{</span>
                   <span class="n">x1</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">powMod</span><span class="o">.</span><span class="na">calculate</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">getC</span><span class="o">(),</span> <span class="n">P</span><span class="o">));</span>
               <span class="o">}</span>
               <span class="k">return</span> <span class="n">x1</span><span class="o">;</span>
           <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
               <span class="n">List</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="n">x2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
               <span class="k">for</span> <span class="o">(</span><span class="n">Long</span> <span class="n">a</span> <span class="o">:</span> <span class="n">prevX</span><span class="o">)</span> <span class="o">{</span>
                   <span class="n">x2</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">powMod</span><span class="o">.</span><span class="na">calculate</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">getC</span><span class="o">(),</span> <span class="n">P</span><span class="o">));</span>
               <span class="o">}</span>
               <span class="k">return</span> <span class="n">x2</span><span class="o">;</span>
           <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
               <span class="n">List</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="n">x3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
               <span class="k">for</span> <span class="o">(</span><span class="n">Long</span> <span class="n">a</span> <span class="o">:</span> <span class="n">prevX</span><span class="o">)</span> <span class="o">{</span>
                   <span class="n">x3</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">powMod</span><span class="o">.</span><span class="na">calculate</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">getD</span><span class="o">(),</span> <span class="n">P</span><span class="o">));</span>
               <span class="o">}</span>
               <span class="k">return</span> <span class="n">x3</span><span class="o">;</span>
           <span class="k">case</span> <span class="mi">4</span><span class="o">:</span>
               <span class="kt">byte</span><span class="o">[]</span> <span class="n">outFile</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="n">prevX</span><span class="o">.</span><span class="na">size</span><span class="o">()];</span>
               <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">prevX</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                   <span class="n">outFile</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="n">powMod</span><span class="o">.</span><span class="na">calculate</span><span class="o">(</span><span class="n">prevX</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">),</span> <span class="n">getD</span><span class="o">(),</span> <span class="n">P</span><span class="o">);</span>
               <span class="o">}</span>
               <span class="n">getFileFromBytes</span><span class="o">(</span><span class="n">path</span><span class="o">,</span> <span class="n">outFile</span><span class="o">);</span>
               <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
       <span class="o">}</span>
       <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
   <span class="o">}</span>
 <span class="c1">// Main.java</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
       <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;&lt;Shamir&gt;&quot;</span><span class="o">);</span>
       <span class="kt">long</span> <span class="n">P</span> <span class="o">=</span> <span class="n">Shamir</span><span class="o">.</span><span class="na">generatePublicP</span><span class="o">();</span>

       <span class="n">Shamir</span> <span class="n">A</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Shamir</span><span class="o">(</span><span class="n">P</span><span class="o">);</span>
       <span class="n">FileManipulation</span><span class="o">.</span><span class="na">KeysToFile</span><span class="o">(</span><span class="s">&quot;Shamir&quot;</span><span class="o">,</span><span class="s">&quot;A&quot;</span><span class="o">,</span> <span class="n">A</span><span class="o">.</span><span class="na">getC</span><span class="o">(),</span> <span class="n">A</span><span class="o">.</span><span class="na">getD</span><span class="o">());</span>

       <span class="n">Shamir</span> <span class="n">B</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Shamir</span><span class="o">(</span><span class="n">P</span><span class="o">);</span>
       <span class="n">FileManipulation</span><span class="o">.</span><span class="na">KeysToFile</span><span class="o">(</span><span class="s">&quot;Shamir&quot;</span><span class="o">,</span><span class="s">&quot;B&quot;</span><span class="o">,</span> <span class="n">B</span><span class="o">.</span><span class="na">getC</span><span class="o">(),</span> <span class="n">B</span><span class="o">.</span><span class="na">getD</span><span class="o">());</span>

       <span class="n">List</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="na">ShamirCalcIteration</span><span class="o">(</span><span class="s">&quot;files/pic.jpg&quot;</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span><span class="mi">1</span><span class="o">);</span>
       <span class="n">List</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="na">ShamirCalcIteration</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="n">x1</span><span class="o">,</span><span class="mi">2</span><span class="o">);</span>
       <span class="n">List</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="n">x3</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="na">ShamirCalcIteration</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="n">x2</span><span class="o">,</span> <span class="mi">3</span><span class="o">);</span>
       <span class="n">List</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="n">x4</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="na">ShamirCalcIteration</span><span class="o">(</span><span class="s">&quot;files/picShamir.jpg&quot;</span><span class="o">,</span> <span class="n">x3</span><span class="o">,</span> <span class="mi">4</span><span class="o">);</span>
 <span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id8">
<h3>Шифр Эль Гамаля<a class="headerlink" href="#id8" title="Ссылка на этот заголовок">¶</a></h3>
<p>Пусть имеются абоненты A , B , C , … , которые хотят передавать друг другу зашифрованные сообщения, не имея никаких защищенных каналов связи. В этом разделе мы рассмотрим шифр, предложенный Эль-Гамалем (Taher ElGamal), который решает эту задачу, используя, в отличие от шифра Шамира, только одну пересылку сообщения. Фактически здесь используется схема Диффи–Хеллмана, чтобы сформировать общий секретный ключ для двух абонентов, передающих друг другу сообщение, и затем сообщение шифруется путем умножения его на этот ключ. Для каждого следующего сообщения секретный ключ вычисляется заново.</p>
<p>Для всей группы абонентов выбираются числа <em>P</em> и <em>G</em> подобно как мы это делали в шифре Диффи-Хэллмана:</p>
<div class="math notranslate nohighlight">
\[P - простое, \ 1 \ &lt; \ G \ &lt; \ (P-1), \ m &lt; P\]</div>
<p>Затем каждый абонент группы выбирает свое секретное число <span class="math notranslate nohighlight">\(С, \ 1 &lt; C &lt; P-1\)</span>, и вычисляет соответсвующее ему открытое число <span class="math notranslate nohighlight">\(D\)</span>:</p>
<div class="math notranslate nohighlight">
\[D = G^{C} \bmod P\]</div>
<p>Ход алгоритма:</p>
<p><strong>Шаг.1:</strong> A формирует случайное число <span class="math notranslate nohighlight">\(k, \ 1 &lt;= k &lt;= P - 2\ \)</span> и вычисляет числа:</p>
<div class="math notranslate nohighlight">
\[\begin{split}r = G^{k} \bmod p, \\
e = m * D_B^{k} \bmod p\end{split}\]</div>
<p>и передает пару числое (r, e) абоненту B</p>
<p><strong>Шаг.2</strong> B, получив (r, e), вычисляет</p>
<div class="math notranslate nohighlight">
\[m' = e * r^{P-1-C_B} \bmod p = m\]</div>
<p>Доказательство:</p>
<div class="math notranslate nohighlight">
\[\begin{split}Подставим \ e \ в \ m' ,\ (e = m * D_B \bmod p) \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}=&gt;  \ m' = m * D_B * r^{P-1-C_B} \bmod p, \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}Подставим \ r \ и \ D_B \ в \ m' , \ (r = G^{k} \bmod p), \ (D_B = G^{C} \bmod P) \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}=&gt;  m' = m * (G^{C_B})^{k} * (G^{k})^{P - 1 - C_B} \bmod p =  m * G^{C_Bk + k(P-1 -kC_B)} \bmod p = m * G^{k(P-1)} \bmod p \\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}По \ теореме \ Ферма: G^{k(P-1)} \bmod p = 1^{k} \bmod p = 1 \\\\\end{split}\]</div>
<p>Листинг программы:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// ElGamal.java</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ElGamal</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="kt">long</span> <span class="n">P</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="kt">long</span> <span class="n">G</span><span class="o">;</span>

  <span class="kd">private</span> <span class="kt">long</span> <span class="n">C</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kt">long</span> <span class="n">D</span><span class="o">;</span>

  <span class="kd">private</span> <span class="kt">long</span> <span class="n">R</span><span class="o">;</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">generateParameters</span><span class="o">()</span> <span class="o">{</span>
      <span class="n">DiffieHellman</span> <span class="n">diffieHellman</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DiffieHellman</span><span class="o">();</span>
      <span class="n">diffieHellman</span><span class="o">.</span><span class="na">generateParameters</span><span class="o">();</span>
      <span class="n">setP</span><span class="o">(</span><span class="n">diffieHellman</span><span class="o">.</span><span class="na">getP</span><span class="o">());</span>
      <span class="n">setG</span><span class="o">(</span><span class="n">diffieHellman</span><span class="o">.</span><span class="na">getG</span><span class="o">());</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="nf">ElGamal</span><span class="o">()</span> <span class="o">{</span>
      <span class="n">SecureRandom</span> <span class="n">srand</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SecureRandom</span><span class="o">();</span>
      <span class="n">srand</span><span class="o">.</span><span class="na">setSeed</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">());</span>
      <span class="n">C</span> <span class="o">=</span> <span class="n">srand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">((</span><span class="kt">int</span><span class="o">)</span><span class="n">P</span> <span class="o">-</span> <span class="mi">2</span><span class="o">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
      <span class="n">D</span> <span class="o">=</span> <span class="n">powMod</span><span class="o">.</span><span class="na">calculate</span><span class="o">(</span><span class="n">G</span><span class="o">,</span> <span class="n">C</span><span class="o">,</span> <span class="n">P</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="nf">elGamalSendMessage</span><span class="o">(</span><span class="kt">long</span> <span class="n">D</span><span class="o">,</span> <span class="n">String</span> <span class="n">path</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
      <span class="n">SecureRandom</span> <span class="n">srand</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SecureRandom</span><span class="o">();</span>
      <span class="n">srand</span><span class="o">.</span><span class="na">setSeed</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">());</span>
      <span class="kt">long</span> <span class="n">k</span> <span class="o">=</span> <span class="n">srand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">((</span><span class="kt">int</span><span class="o">)</span><span class="n">P</span> <span class="o">-</span> <span class="mi">3</span><span class="o">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
      <span class="kt">byte</span><span class="o">[]</span> <span class="n">byteArray</span> <span class="o">=</span> <span class="n">getFileBytes</span><span class="o">(</span><span class="n">path</span><span class="o">);</span>
      <span class="n">List</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>

      <span class="kt">long</span> <span class="n">partD</span> <span class="o">=</span> <span class="n">powMod</span><span class="o">.</span><span class="na">calculate</span><span class="o">(</span><span class="n">D</span><span class="o">,</span> <span class="n">k</span><span class="o">,</span> <span class="n">P</span><span class="o">);</span>

      <span class="k">for</span> <span class="o">(</span><span class="kt">byte</span> <span class="n">b</span> <span class="o">:</span> <span class="n">byteArray</span><span class="o">)</span> <span class="o">{</span>
          <span class="n">E</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">powMod</span><span class="o">.</span><span class="na">calculate</span><span class="o">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">partD</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="n">P</span><span class="o">));</span>
      <span class="o">}</span>
      <span class="n">R</span> <span class="o">=</span> <span class="n">powMod</span><span class="o">.</span><span class="na">calculate</span><span class="o">(</span><span class="n">G</span><span class="o">,</span> <span class="n">k</span><span class="o">,</span> <span class="n">P</span><span class="o">);</span>
      <span class="k">return</span> <span class="n">E</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">elGamalReceiveMessage</span> <span class="o">(</span><span class="kt">long</span> <span class="n">R</span><span class="o">,</span> <span class="n">List</span> <span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="n">E</span><span class="o">,</span> <span class="n">String</span> <span class="n">Out</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
      <span class="kt">byte</span> <span class="o">[]</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="n">E</span><span class="o">.</span><span class="na">size</span><span class="o">()];</span>
      <span class="kt">long</span> <span class="n">partR</span> <span class="o">=</span> <span class="n">powMod</span><span class="o">.</span><span class="na">calculate</span><span class="o">(</span><span class="n">R</span><span class="o">,</span> <span class="n">P</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">C</span><span class="o">,</span> <span class="n">P</span><span class="o">);</span>

      <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">E</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
          <span class="n">result</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="n">powMod</span><span class="o">.</span><span class="na">calculate</span><span class="o">(</span><span class="n">E</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">)</span> <span class="o">*</span> <span class="n">partR</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="n">P</span><span class="o">);</span>
      <span class="o">}</span>
      <span class="n">getFileFromBytes</span><span class="o">(</span><span class="n">Out</span><span class="o">,</span> <span class="n">result</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">long</span> <span class="nf">getC</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">C</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">long</span> <span class="nf">getD</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">D</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">long</span> <span class="nf">getR</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">R</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setP</span><span class="o">(</span><span class="kt">int</span> <span class="n">p</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">P</span> <span class="o">=</span> <span class="n">p</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setG</span><span class="o">(</span><span class="kt">int</span> <span class="n">g</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">G</span> <span class="o">=</span> <span class="n">g</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// Main.java</span>

 <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>
   <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
      <span class="n">ElGamal</span><span class="o">.</span><span class="na">generateParameters</span><span class="o">();</span>

      <span class="n">ElGamal</span> <span class="n">N</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ElGamal</span><span class="o">();</span>
      <span class="n">FileManipulation</span><span class="o">.</span><span class="na">KeysToFile</span><span class="o">(</span><span class="s">&quot;ElGamal&quot;</span><span class="o">,</span> <span class="s">&quot;N&quot;</span><span class="o">,</span> <span class="n">N</span><span class="o">.</span><span class="na">getC</span><span class="o">(),</span> <span class="n">N</span><span class="o">.</span><span class="na">getD</span><span class="o">());</span>

      <span class="n">ElGamal</span> <span class="n">M</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ElGamal</span><span class="o">();</span>
      <span class="n">FileManipulation</span><span class="o">.</span><span class="na">KeysToFile</span><span class="o">(</span><span class="s">&quot;ElGamal&quot;</span><span class="o">,</span> <span class="s">&quot;M&quot;</span><span class="o">,</span> <span class="n">M</span><span class="o">.</span><span class="na">getC</span><span class="o">(),</span> <span class="n">M</span><span class="o">.</span><span class="na">getD</span><span class="o">());</span>

      <span class="n">List</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="n">E</span> <span class="o">=</span>  <span class="n">N</span><span class="o">.</span><span class="na">elGamalSendMessage</span><span class="o">(</span><span class="n">M</span><span class="o">.</span><span class="na">getD</span><span class="o">(),</span> <span class="s">&quot;files/pic.jpg&quot;</span><span class="o">);</span>
      <span class="n">M</span><span class="o">.</span><span class="na">elGamalReceiveMessage</span><span class="o">(</span><span class="n">N</span><span class="o">.</span><span class="na">getR</span><span class="o">(),</span> <span class="n">E</span><span class="o">,</span> <span class="s">&quot;files/picElgamal.jpg&quot;</span><span class="o">);</span>

      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;ElGamal successful complete&quot;</span><span class="o">);</span>

   <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="rsa">
<h3>Шифр RSA<a class="headerlink" href="#rsa" title="Ссылка на этот заголовок">¶</a></h3>
<p>Мы видели, что шифр Шамира полностью решает задачу обмена сообщениями, закрытыми для прочтения, в случае, когда абоненты могут пользоваться только открытыми линиями связи. Однако при этом сообщение пересылается три раза от одного абонента к другому, что является недостатком. Шифр Эль-Гамаля позволяет решить ту же задачу за одну пересылку данных, но объем передаваемого шифротекста в два раза превышает объем сообщения. Система RSA лишена подобных недостатков. Интересно то, что она базируется на другой односторонней функции, отличной от дискретного логарифма. Кроме того, здесь мы встретимся с еще одним изобретением современной криптографии – односторонней функцией с «лазейкой» (trapdoor function)</p>
<p>Эта система базируется на следующих двух фактах из теории
чисел:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Задача проверки числа на простоту является сравнительно легкой</li>
<li>Задача разложения чисел вида <span class="math notranslate nohighlight">\(n = pq\)</span> (p и q — простые числа)</li>
</ol>
</div></blockquote>
<p>на множители является очень трудной, если мы знаем только n , а p и q — большие числа (это так называемая задача факторизации)</p>
</div>
</div>
<div class="section" id="id9">
<h2>Глава 2. Методы взлома шифров, основанных на дискретном логарифмировании<a class="headerlink" href="#id9" title="Ссылка на этот заголовок">¶</a></h2>
<div class="section" id="id10">
<h3>Метод «шаг младенца, шаг великана»<a class="headerlink" href="#id10" title="Ссылка на этот заголовок">¶</a></h3>
<p>Это был один из первых методов, который показал, что задача вычисления дискретного логарифма может быть решена значительно быстрее, чем методом перебора. Перейдем к описанию этого метода отыскания x</p>
<p>Задача поиска x, при известных a и y. Сначала берем два целых числа m и k, такие что</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[{ m * k &gt; p, \quad m = k = \sqrt{p} + 1 }\]</div>
</div></blockquote>
<p>Вычислим два ряда чисел:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}y,ay,a^{2y},...a^{m-1}y \quad (\bmod p) \\
  a^{m},a^{2m},...a^{km} \quad (\bmod p)\end{split}\]</div>
<p>(все вычисления по модулю p)</p>
</div></blockquote>
<p>Найдем такие i и j, для которых выполняется равенство</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[{ a^{im} = a^{i} * y }\]</div>
</div></blockquote>
<p>Число x:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[{ x = i * m - j }\]</div>
</div></blockquote>
<p>Листинг программы:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BabyGiantSteps</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">calculate</span><span class="o">(</span><span class="kt">long</span> <span class="n">a</span><span class="o">,</span> <span class="kt">long</span> <span class="n">p</span><span class="o">,</span> <span class="kt">long</span> <span class="n">y</span><span class="o">)</span>  <span class="o">{</span>
        <span class="n">SecureRandom</span> <span class="n">srand</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SecureRandom</span><span class="o">();</span>
        <span class="n">srand</span><span class="o">.</span><span class="na">setSeed</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">());</span>
        <span class="kt">int</span><span class="o">[]</span> <span class="n">ji</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="mi">2</span><span class="o">];</span>
        <span class="n">ji</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
        <span class="n">ji</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
        <span class="kt">long</span> <span class="n">m</span><span class="o">,</span> <span class="n">k</span><span class="o">;</span>
        <span class="k">do</span> <span class="o">{</span>
            <span class="n">m</span> <span class="o">=</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span><span class="n">Math</span><span class="o">.</span><span class="na">sqrt</span><span class="o">(</span><span class="n">p</span><span class="o">)+</span><span class="mi">1</span><span class="o">;</span><span class="c1">// sqrt(p)+1</span>
            <span class="n">k</span> <span class="o">=</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span><span class="n">Math</span><span class="o">.</span><span class="na">sqrt</span><span class="o">(</span><span class="n">p</span><span class="o">)+</span><span class="mi">1</span><span class="o">;;</span>
        <span class="o">}</span> <span class="k">while</span> <span class="o">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">p</span><span class="o">);</span>
<span class="c1">//        System.out.println(&quot;m = &quot;+m+&quot; k = &quot;+k);</span>
        <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="n">rowY</span><span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
        <span class="c1">// y, ay, a^2y...</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">m</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>
            <span class="k">if</span><span class="o">(!</span><span class="n">rowY</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(((</span><span class="kt">long</span><span class="o">)</span><span class="n">Math</span><span class="o">.</span><span class="na">pow</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">j</span><span class="o">)*</span><span class="n">y</span><span class="o">)</span> <span class="o">%</span> <span class="n">p</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">rowY</span><span class="o">.</span><span class="na">put</span><span class="o">(((</span><span class="kt">long</span><span class="o">)</span><span class="n">Math</span><span class="o">.</span><span class="na">pow</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">j</span><span class="o">)*</span><span class="n">y</span><span class="o">)</span> <span class="o">%</span> <span class="n">p</span><span class="o">,</span> <span class="n">j</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="c1">// a^m, a^2m ...</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">k</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">rowY</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(((</span><span class="kt">long</span><span class="o">)</span><span class="n">Math</span><span class="o">.</span><span class="na">pow</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">i</span><span class="o">*</span><span class="n">m</span><span class="o">))</span> <span class="o">%</span> <span class="n">p</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">ji</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="n">rowY</span><span class="o">.</span><span class="na">get</span><span class="o">((</span><span class="kt">long</span><span class="o">)</span><span class="n">Math</span><span class="o">.</span><span class="na">pow</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">i</span><span class="o">*</span><span class="n">m</span><span class="o">)%</span><span class="n">p</span><span class="o">);</span>
                <span class="n">ji</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">;</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">ji</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">ji</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="o">))</span> <span class="o">{</span>
            <span class="c1">//  no solutions</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">ji</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">*</span> <span class="n">m</span> <span class="o">-</span> <span class="n">ji</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id11">
<h2>Используемая литература<a class="headerlink" href="#id11" title="Ссылка на этот заголовок">¶</a></h2>
<p><a class="reference external" href="ryabko_fionov_kriptograficheskie_metody_zashchity_i.pdf">Б.Я. Рябко, А.Н. Фионов. «Криптографические методы защиты информации»</a></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Авторские права 2020, Bulatov Alexandr

    </p>
  </div>
    
    
    
    Собрано при помощи <a href="http://sphinx-doc.org/">Sphinx</a> с использованием
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">темы,</a>
    
    предоставленной <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>